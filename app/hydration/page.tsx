\"use client\";\n\nimport { motion } from \"framer-motion\";\nimport { ArrowLeft, Droplet, Plus, AlertTriangle, BarChart3 } from \"lucide-react\";\nimport FloatingBubbles from \"../floating-bubbles\";\nimport { useHydration } from \"@/contexts/hydration-context\";\nimport Link from \"next/link\";\n\ninterface HydrationScreenProps {\n  percentage?: number;\n  onBack?: () => void;\n}\n\nexport default function HydrationScreen({ percentage, onBack }: HydrationScreenProps) {\n  const { state, logDrink } = useHydration();\n  const { userProfile, wellnessState, hydrationBreakdown } = state;\n\n  const handleAddWater = (amount: number, name: string, multiplier = 1.0, electrolytes = false, caffeine = false) => {\n    const drinkEntry = {\n      id: Date.now().toString(),\n      name,\n      estimatedVolumeML: amount,\n      electrolyteSupport: electrolytes,\n      caffeinePresent: caffeine,\n      timestamp: new Date().toISOString(),\n      hydrationMultiplier: multiplier,\n    };\n    logDrink(drinkEntry);\n    if (typeof window !== \"undefined\" && navigator.vibrate) {\n      navigator.vibrate(20);\n    }\n  };\n\n  return (\n    <div className=\"h-full w-full bg-gradient-to-b from-blue-400 to-blue-600 flex flex-col\">\n      <FloatingBubbles count={10} maxSize={30} />\n      {/* Header */}\n      <motion.div\n        className=\"flex items-center p-4 z-10\"\n        initial={{ opacity: 0, y: -20 }}\n        animate={{ opacity: 1, y: 0 }}\n        transition={{ duration: 0.3 }}\n      >\n        {onBack && (\n          <button\n            className=\"w-10 h-10 rounded-full bg-white/20 backdrop-blur-sm flex items-center justify-center\"\n            onClick={onBack}\n          >\n            <ArrowLeft className=\"w-5 h-5 text-white\" />\n          </button>\n        )}\n        <h1 className=\"text-2xl font-light text-white ml-4\">Hydration Tracker</h1>\n      </motion.div>\n      {/* Main content */}\n      <div className=\"flex-1 flex flex-col p-6 z-10 overflow-y-auto\">\n        {!userProfile ? (\n          <motion.div\n            className=\"bg-white/20 backdrop-blur-sm border border-white/30 rounded-xl p-5 mb-6\"\n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            transition={{ duration: 0.5 }}\n          >\n            <div className=\"flex items-center mb-3\">\n              <div className=\"w-10 h-10 rounded-full bg-blue-400/30 flex items-center justify-center mr-3\">\n                <AlertTriangle className=\"w-5 h-5 text-white\" />\n              </div>\n              <h2 className=\"text-white text-lg font-medium\">Complete Your Assessment</h2>\n            </div>\n            <p className=\"text-white/80 text-sm mb-4\">\n              To get personalized hydration recommendations, please complete your hydration assessment.\n            </p>\n            <Link href=\"/assessment\">\n              <motion.button\n                className=\"w-full py-3 rounded-lg bg-blue-500/60 text-white\"\n                whileHover={{ scale: 1.02, backgroundColor: \"rgba(59, 130, 246, 0.7)\" }}\n                whileTap={{ scale: 0.98 }}\n              >\n                Complete Assessment\n              </motion.button>\n            </Link>\n          </motion.div>\n        ) : (\n          <>\n            {/* User profile summary */}\n            <motion.div\n              className=\"bg-white/20 backdrop-blur-sm border border-white/30 rounded-xl p-4 mb-4\"\n              initial={{ opacity: 0, y: 20 }}\n              animate={{ opacity: 1, y: 0 }}\n              transition={{ duration: 0.5, delay: 0.1 }}\n            >\n              <div className=\"grid grid-cols-4 gap-2 text-xs text-white/80\">\n                <div>Height: {userProfile.height}cm</div>\n                <div>Weight: {userProfile.weight}kg</div>\n                <div>Age: {userProfile.age}</div>\n                <div>Activity: {userProfile.activityLevel}</div>\n              </div>\n            </motion.div>\n            {/* Hydration requirement bar */}\n            <motion.div\n              className=\"bg-white/20 backdrop-blur-sm border border-white/30 rounded-xl p-5 mb-6\"\n              initial={{ opacity: 0, y: 20 }}\n              animate={{ opacity: 1, y: 0 }}\n              transition={{ duration: 0.5, delay: 0.2 }}\n            >\n              <h3 className=\"text-lg font-semibold text-white mb-3\">Daily Hydration Progress</h3>\n              {/* Progress bar with breakdown */}\n              <div className=\"h-6 bg-white/20 rounded-full overflow-hidden mb-2\">\n                {hydrationBreakdown.map((item, index) => (\n                  <div\n                    key={index}\n                    className={`h-full ${item.color === \"bg-primary/50\" ? \"bg-blue-400/50\" : \"bg-blue-500/70\"}`}\n                    style={{\n                      width: `${(item.amount / state.dailyGoal) * 100}%`,\n                      float: \"left\",\n                    }}\n                  />\n                ))}\n              </div>\n              {/* Current progress */}\n              <div className=\"h-2 bg-white/20 rounded-full overflow-hidden mb-2\">\n                <div className=\"h-full bg-blue-300\" style={{ width: `${state.hydrationPercentage}%` }} />\n              </div>\n              <div className=\"flex justify-between text-sm text-white\">\n                <span>Current: {state.currentHydration}ml</span>\n                <span>Goal: {state.dailyGoal}ml</span>\n              </div>\n              {/* Breakdown legend */}\n              <div className=\"grid grid-cols-2 gap-2 text-sm mt-3\">\n                {hydrationBreakdown.map((item, index) => (\n                  <div key={index} className=\"flex items-center\">\n                    <div\n                      className={`w-3 h-3 rounded-full mr-2 ${\n                        item.color === \"bg-primary/50\" ? \"bg-blue-400/50\" : \"bg-blue-500/70\"\n                      }`}\n                    />\n                    <span className=\"text-white/90\">\n                      {item.category}: {item.amount}ml\n                    </span>\n                  </div>\n                ))}\n              </div>\n            </motion.div>\n          </>\n        )}\n        {/* Quick log options */}\n        <motion.div\n          className=\"bg-white/20 backdrop-blur-sm border border-white/30 rounded-xl p-5 mb-6\"\n          initial={{ opacity: 0, y: 20 }}\n          animate={{ opacity: 1, y: 0 }}\n          transition={{ duration: 0.5, delay: 0.3 }}\n        >\n          <h3 className=\"text-lg font-semibold text-white mb-3\">Log Water Intake</h3>\n          <div className=\"grid grid-cols-2 gap-3\">\n            <motion.button\n              className=\"flex items-center justify-center p-4 rounded-xl bg-white/20 backdrop-blur-sm border border-white/30\"\n              whileHover={{ scale: 1.02, backgroundColor: \"rgba(255, 255, 255, 0.3)\" }}\n              whileTap={{ scale: 0.98 }}\n              onClick={() => handleAddWater(250, \"Water\")}\n            >\n              <Droplet className=\"w-5 h-5 text-white mr-2\" />\n              <span className=\"text-white\">250ml water</span>\n            </motion.button>\n            <motion.button\n              className=\"flex items-center justify-center p-4 rounded-xl bg-white/20 backdrop-blur-sm border border-white/30\"\n              whileHover={{ scale: 1.02, backgroundColor: \"rgba(255, 255, 255, 0.3)\" }}\n              whileTap={{ scale: 0.98 }}\n              onClick={() => handleAddWater(500, \"Water\")}\n            >\n              <Droplet className=\"w-5 h-5 text-white mr-2\" />\n              <span className=\"text-white\">500ml water</span>\n            </motion.button>\n            <motion.button\n              className=\"flex items-center justify-center p-4 rounded-xl bg-white/20 backdrop-blur-sm border border-white/30\"\n              whileHover={{ scale: 1.02, backgroundColor: \"rgba(255, 255, 255, 0.3)\" }}\n              whileTap={{ scale: 0.98 }}\n              onClick={() => handleAddWater(250, \"Coffee\", 0.6, false, true)}\n            >\n              <Droplet className=\"w-5 h-5 text-white mr-2\" />\n              <span className=\"text-white\">Coffee 250ml</span>\n            </motion.button>\n            <motion.button\n              className=\"flex items-center justify-center p-4 rounded-xl bg-white/20 backdrop-blur-sm border border-white/30\"\n              whileHover={{ scale: 1.02, backgroundColor: \"rgba(255, 255, 255, 0.3)\" }}\n              whileTap={{ scale: 0.98 }}\n              onClick={() => handleAddWater(330, \"Coconut Water\", 1.1, true, false)}\n            >\n              <Droplet className=\"w-5 h-5 text-white mr-2\" />\n              <span className=\"text-white\">Coconut water</span>\n            </motion.button>\n          </div>\n          <motion.button\n            className=\"mt-3 w-full flex items-center justify-center p-3 rounded-xl bg-blue-500/40 backdrop-blur-sm border border-white/30\"\n            whileHover={{ scale: 1.02, backgroundColor: \"rgba(59, 130, 246, 0.5)\" }}\n            whileTap={{ scale: 0.98 }}\n            onClick={() => {\n              /* Open custom drink modal */\n            }}\n          >\n            <Plus className=\"w-5 h-5 text-white mr-2\" />\n            <span className=\"text-white\">Custom drink</span>\n          </motion.button>\n        </motion.div>\n        {/* Wellness state */}\n        {wellnessState && wellnessState.dehydrationLevel !== \"None\" && (\n          <motion.div\n            className={`bg-white/20 backdrop-blur-sm border rounded-xl p-5 mb-6 ${\n              wellnessState.dehydrationLevel === \"Mild\"\n                ? \"border-orange-400/50\"\n                : wellnessState.dehydrationLevel === \"Moderate\"\n                ? \"border-orange-500/50\"\n                : \"border-purple-500/50\"\n            }`}\n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            transition={{ duration: 0.5, delay: 0.4 }}\n          >\n            <div className=\"flex items-center mb-3\">\n              <div className=\"w-10 h-10 rounded-full bg-blue-400/30 flex items-center justify-center mr-3\">\n                <AlertTriangle className=\"w-5 h-5 text-white\" />\n              </div>\n              <div>\n                <h3 className=\"text-lg font-medium text-white\">Dehydration Alert</h3>\n                <p className=\"text-white/80 text-sm\">{wellnessState.dehydrationLevel} dehydration detected</p>\n              </div>\n            </div>\n            <div className=\"bg-white/10 rounded-lg p-3 text-white/90 text-sm\">\n              <p>Based on your symptoms, we recommend increasing your fluid intake.</p>\n              <Link href=\"/wellness\">\n                <motion.button\n                  className=\"mt-2 w-full py-2 rounded-lg bg-blue-500/40 text-white text-sm\"\n                  whileHover={{ scale: 1.02, backgroundColor: \"rgba(59, 130, 246, 0.5)\" }}\n                  whileTap={{ scale: 0.98 }}\n                >\n                  View Recommendations\n                </motion.button>\n              </Link>\n            </div>\n          </motion.div>\n        )}\n        {/* Add this button to the HydrationScreen component, just before the reflective suggestion div */}\n        <motion.button\n          className=\"w-full py-3 rounded-lg bg-blue-500/40 text-white flex items-center justify-center\"\n          whileHover={{ scale: 1.02, backgroundColor: \"rgba(59, 130, 246, 0.5)\" }}\n          whileTap={{ scale: 0.98 }}\n          onClick={() => {\n            window.location.href = \"/history\";\n          }}\n          initial={{ opacity: 0, y: 20 }}\n          animate={{ opacity: 1, y: 0 }}\n          transition={{ duration: 0.5, delay: 0.6 }}\n        >\n          <BarChart3 className=\"w-5 h-5 text-white mr-2\" />\n          <span>View Hydration History</span>\n        </motion.button>\n        {/* Reflective suggestion */}\n        <motion.div\n          className=\"mt-auto bg-white/10 backdrop-blur-sm border border-white/20 rounded-xl p-4 text-center\"\n          initial={{ opacity: 0 }}\n          animate={{ opacity: 1 }}\n          transition={{ duration: 0.5, delay: 0.5 }}\n        >\n          <p className=\"text-white text-sm\">\n            {state.hydrationPercentage >= 50\n              ? `You're ${state.hydrationPercentage}% to your daily goal — keep going!`\n              : `You're ${state.hydrationPercentage}% to your daily goal — time for a sip?`}\n          </p>\n        </motion.div>\n      </div>\n    </div>\n  );\n}\n
